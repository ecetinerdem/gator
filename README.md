# 🐹 Gator CLI

Gator is a simple **Go-based command-line tool** that manages user data through a PostgreSQL database.  
It supports operations like registering new users, logging in, listing users, and resetting the user table — all through an easy-to-use CLI interface.

---

## ⚙️ Features

- ✅ Register new users  
- 🔐 Log in as an existing user  
- 🧾 List all users and highlight the current one  
- 🗑️ Reset (delete) all users  
- 💾 Store configuration in a local JSON file (`~/.gatorconfig.json`)  

---

## 🧠 Project Structure

```
.
├── cmd/
│   └── main.go              # Entry point of the program
├── internal/
│   ├── config/              # Contains command handlers and state management
│   │   └── config.go
│   └── database/            # Generated database access code (from sqlc)
└── go.mod / go.sum          # Go module dependencies
```

---

## 🚀 Getting Started

### 1️⃣ Prerequisites

Make sure you have:
- Go 1.20+ installed  
- PostgreSQL running  
- `github.com/lib/pq` installed  
- `sqlc` (optional, if regenerating database code)

---

### 2️⃣ Setup

Clone the repository:

```bash
git clone https://github.com/ecetinerdem/gator.git
cd gator
```

Install dependencies:

```bash
go mod tidy
```

---

### 3️⃣ Configure the Database

Create a configuration file in your home directory:

```
~/.gatorconfig.json
```

Example content:
```json
{
  "db_url": "postgres://username:password@localhost:5432/gatordb?sslmode=disable",
  "current_user_name": ""
}
```

---

### 4️⃣ Run the CLI

Run directly:
```bash
go run ./cmd
```

Or build and execute:
```bash
go build -o gator ./cmd
./gator <command> [args...]
```

---

## 💻 Available Commands

| Command      | Description | Example |
|---------------|-------------|----------|
| `register`    | Create a new user and set them as current | `./gator register alice` |
| `login`       | Log in as an existing user | `./gator login alice` |
| `users`       | List all registered users | `./gator users` |
| `reset`       | Delete all users from the database | `./gator reset` |

---

## 🧩 How It Works

- **`main.go`** initializes:
  - The configuration file (`~/.gatorconfig.json`)
  - Database connection
  - Command registry
- **`config` package** defines:
  - `State` → holds app state (config + DB)
  - `Commands` → maps command names to handler functions
  - Handlers like `LoginHandler`, `RegisterHandler`, etc.

Each command handler uses:
```go
func(s *State, cmd Command) error
```
and returns an error if something goes wrong.

---

## 🧰 Example Workflow

```bash
# Register a new user
./gator register alice

# Log in as that user
./gator login alice

# List all users
./gator users

# Reset (delete) all users
./gator reset
```

---

## 🐘 Database

This project uses **PostgreSQL** with an internal `database` package generated by `sqlc`.  
Expected SQL schema includes a `users` table with:
- `id` (UUID)
- `name` (string)
- `created_at`
- `updated_at`

---

## ⚠️ Error Handling

- Unknown command → `unknown command: <name>`  
- Non-existent user → `user <name> does not exist`  
- Missing arguments → descriptive error messages  

---

## 🧑‍💻 Author

**E. Çetin Erdem**  
[GitHub: @ecetinerdem](https://github.com/ecetinerdem)

---

## 📄 License

This project is licensed under the **MIT License**.
